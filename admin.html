<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>Admin Canti</title>
</head>
<body>
    <h2>Inserisci i canti</h2>
    <div id="form"></div>
    <button onclick="salva()">Salva</button>
    <button onclick="logout()">Logout</button>

    <script>
        const form = document.getElementById("form");
        for (let i = 0; i < 10; i++) {
            form.innerHTML += `
                <input placeholder="Titolo ${i+1}" id="titolo${i}">
                <input placeholder="Link ${i+1}" id="link${i}"><br>
            `;
        }

        async function salva() {
            const canti = [];
            for (let i = 0; i < 10; i++) {
                let titolo = document.getElementById("titolo" + i).value;
                let link = document.getElementById("link" + i).value;
                if (titolo) canti.push({ titolo, link });
            }

            const res = await fetch("https://coro-delle-dieci.onrender.com/api/canti", {
                method: "POST",
                credentials: "include",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(canti)
            });

            if (res.ok) alert("Canti salvati!");
            else alert("Errore nel salvataggio");
        }

        async function logout() {
            await fetch("https://coro-delle-dieci.onrender.com/logout", {
                method: "POST",
                credentials: "include"
            });
            window.location.href = "login.html";
        }
    </script>
</body>
</html>